%traceplot_ACF_P.m%Trace plots and ACF plots for elements of Pfunction tsp = traceplot_ACF_P(PSnor);[aa,bb,cc]=size(PSnor);vecPfree=reshape(PSnor,aa*bb,cc);zeroindexall=find(PSnor(:,:,1)==0);vecPfree(zeroindexall,:)=[];vecPfreeT=vecPfree';[N,pp]=size(vecPfreeT);n1=29;t=0:n1;ubound=1.96/sqrt(N);lbound=-1.96/sqrt(N);zmean=mean(vecPfreeT);roS=zeros(N,pp);for j=1:pp    z=vecPfreeT(:,j);    zmeanj=zmean(j);    ro=zeros(1,N-1);    for i=1:N-1        ro(i)=((z(1:N-i)-zmeanj*ones(N-i,1))'*(z(i+1:N)-zmeanj*ones(N-i,1)))/sum((z-zmeanj*ones(N,1)).^2);    end    ro=[1 ro];    roS(:,j)=ro';    %n1=round(n/2);endfigureii=0;for j=[1 3 5]    ii=ii+1;    subplot(3,2,j)    plot(vecPfree(ii,:))    axis tight    xlabel('sample #')    ylabel('P')    title(ii)        subplot(3,2,j+1)    hold on    stem(t,roS([1:(n1+1)],ii))    plot(t,ubound*ones(length(t)));    plot(t,0*ones(length(t)));    plot(t,lbound*ones(length(t)));    xlabel('Lag')    ylabel('ACF');    axis tight    hold offend