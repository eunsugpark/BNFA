%traceplots.m%%Trace plots of P, A, and diagonal elements of Sigmafunction tsp = traceplot(nrow,ncol,PSnor,ASnor,DSigmaS);%nrow: number of plots to display in one column per window%ncol: number of plots to display in one row per windownplot=nrow*ncol;  %total number of plots to display per window%-------Trace plot of P---%figure[aa,bb,cc]=size(PSnor);J=bb;vecPfree=reshape(PSnor,aa*bb,cc);%zeroindexall=find(muP==0)zeroindexall=find(PSnor(:,:,1)==0);vecPfree(zeroindexall,:)=[];for j=1:nplot    subplot(nrow,ncol,j)    plot(vecPfree(j,:))    axis tight    xlabel('sample #')    ylabel('P')    title(j)end%-------Time plot of A---%figure[aa,bb,cc]=size(ASnor);vecAS=reshape(ASnor,aa*bb,cc);for j=1:nplot    subplot(nrow,ncol,j)    plot(vecAS(j,:))    axis tight    xlabel('sample #')    ylabel('A')    title(j)end%-------Trace plot of DSigma---%figurefor j=1:min(nplot,J)    subplot(nrow,ncol,j)    plot(DSigmaS(j,:))    axis tight    xlabel('sample #')    ylabel('Sigma')    title(j)end