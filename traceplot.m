function traceplot(nrow,ncol,PSnor,ASnor,k,SigmaS)%--------------------------------------------% function name: traceplot%% Produce trace plots of P, A, and diagonal elements of Sigma%% Usage example:% traceplot(nrow,ncol,PSnor,ASnor,k,SigmaS);%% Inputs:% nrow: number of plots to display in one column per window% ncol: number of plots to display in one row per window% PSnor: Stored MCMC samples for P (q by J by nsample)% (q=number of sources, J=number of variables, nsample=number of stored samples)% ASnor: Stored MCMC samples for A (T by q by nsample)% (T=number of observations (times), q=number of sources)% k: Source number (between 1 and q) to plot for trace plots of A  % SigmaS: Stored MCMC samples for diagonal elements of Sigma (nsample by J)%% Eun Sug Park, August 2020% Last updated February 2021%----------------------------------------nplot=nrow*ncol;  %total number of plots to display per window%-------Trace plot of P---%[q,J,nsample]=size(PSnor);vecPSfree=reshape(PSnor,q*J,nsample)';zeroindexP=find(PSnor(:,:,1)==0);vecPSfree(:,zeroindexP)=[]; %Stored samples for free elements of P [nsample,s]=size(vecPSfree); %s: number of free elements of Pfigure%vnamesP: string vector of variable names for elements of P (stacked column-wise)vnamesP=strings(q*J,1);ii=0;for j=1:J   for i=1:q     ii=ii+1;     vnamesP(ii)= ['P[', num2str(i), ',', num2str(j), ']'];   endendvnamesP(zeroindexP)=[];ii=0;for j=1:min(nplot,s)    ii=ii+1;    subplot(nrow,ncol,j)    plot(vecPSfree(:,ii))    axis tight    xlabel('sample #')    ylabel('P')    title(vnamesP(ii));end%-------Time plot of A---%[T,q,nsample]=size(ASnor);vecAS=reshape(ASnor,T*q,nsample)'; %nsample by Tqfigure%vnamesA: string vector of variable names for elements of A (stacked column-wise)vnamesA=strings(T*q,1);ii=0;for j=1:q   for i=1:T     ii=ii+1;     vnamesA(ii)= ['A[', num2str(i), ',', num2str(j), ']'];   endendii=(k-1)*T;for j=1:min(nplot,T*q);    ii=ii+1;    subplot(nrow,ncol,j)    plot(vecAS(:,ii))    axis tight    xlabel('sample #')    ylabel('A')       title(vnamesA(ii));end%-------Trace plot of diagSigma---%figurefor j=1:min(nplot,J)    subplot(nrow,ncol,j)    plot(SigmaS(:,j))    axis tight    xlabel('sample #')    ylabel(['Sigma ',num2str(j)])end